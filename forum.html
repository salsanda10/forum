<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–§–æ—Ä—É–º</title>
<style>
body {
  font-family: system-ui, sans-serif;
  margin: 20px auto;
  max-width: 800px;
  background: #f7f7f7;
  color: #333;
}
h1 {
  text-align: center;
}
#auth, #forum {
  background: white;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
input, button, textarea {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
  border: 1px solid #ccc;
  border-radius: 6px;
}
button {
  background: #0077ff;
  color: white;
  cursor: pointer;
  font-weight: bold;
}
button:hover {
  background: #0059c1;
}
.topic {
  background: #fff;
  margin: 10px 0;
  padding: 10px;
  border-radius: 8px;
  border-left: 4px solid #0077ff;
}
.message {
  background: #f9f9f9;
  margin: 5px 0;
  padding: 8px;
  border-radius: 5px;
}
.toolbar button {
  width: auto;
  margin: 2px;
  background: #e9e9e9;
  color: #333;
}
.toolbar button:hover {
  background: #ccc;
}
[contenteditable] {
  min-height: 80px;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  background: #fff;
}
</style>
</head>
<body>

<h1>–ú–∏–Ω–∏-–§–æ—Ä—É–º</h1>

<div id="auth">
  <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è / –í—Ö–æ–¥</h2>
  <input id="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
  <input id="password" placeholder="–ü–∞—Ä–æ–ª—å" type="password">
  <button onclick="register()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
  <button onclick="login()">–í—Ö–æ–¥</button>
</div>

<div id="forum" style="display:none;">
  <h2>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ç–µ–º—É</h2>
  <input id="topicTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã">
  
  <div class="toolbar">
    <button onclick="format('bold')"><b>B</b></button>
    <button onclick="format('italic')"><i>I</i></button>
    <button onclick="format('insertOrderedList')">1.</button>
    <button onclick="format('insertUnorderedList')">‚Ä¢</button>
    <button onclick="format('createLink', prompt('–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É:'))">üîó</button>
    <button onclick="format('formatBlock','blockquote')">‚ùù</button>
    <button onclick="format('formatBlock','pre')">[code]</button>
  </div>

  <div id="topicText" contenteditable="true" placeholder="–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è..."></div>
  <button onclick="createTopic()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ç–µ–º—É</button>

  <h2>–¢–µ–º—ã</h2>
  <div id="topics"></div>
</div>

<script>
let users = JSON.parse(localStorage.getItem('users') || '{}');
let currentUser = localStorage.getItem('currentUser');
let topics = JSON.parse(localStorage.getItem('topics') || '[]');
const authDiv = document.getElementById('auth');
const forumDiv = document.getElementById('forum');

if (currentUser) showForum();

function saveData() {
  localStorage.setItem('users', JSON.stringify(users));
  localStorage.setItem('topics', JSON.stringify(topics));
}

function register() {
  let u = username.value.trim();
  let p = password.value;
  if (!u || !p) return alert("–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å");
  if (users[u]) return alert("–¢–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –µ—Å—Ç—å!");
  users[u] = p;
  currentUser = u;
  localStorage.setItem('currentUser', u);
  saveData();
  showForum();
}

function login() {
  let u = username.value.trim();
  let p = password.value;
  if (!u || !p) return alert("–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å");
  if (users[u] !== p) return alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å");
  currentUser = u;
  localStorage.setItem('currentUser', u);
  showForum();
}

function showForum() {
  authDiv.style.display = 'none';
  forumDiv.style.display = 'block';
  renderTopics();
}

function format(cmd, val=null) {
  document.execCommand(cmd, false, val);
}

function createTopic() {
  let title = topicTitle.value.trim();
  let text = topicText.innerHTML.trim();
  if (!title || !text) return alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ç–µ–∫—Å—Ç");
  topics.unshift({title, text, author: currentUser, date: new Date().toLocaleString()});
  topicTitle.value = '';
  topicText.innerHTML = '';
  saveData();
  renderTopics();
}

function renderTopics() {
  topicsDiv.innerHTML = '';
  topics.forEach((t, i) => {
    let div = document.createElement('div');
    div.className = 'topic';
    div.innerHTML = `<b>${t.title}</b> <small>–æ—Ç ${t.author}, ${t.date}</small><br>${t.text}`;
    topicsDiv.appendChild(div);
  });
}
</script>

</body>
</html>
